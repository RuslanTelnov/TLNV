# План интеграции МойСклад -> Ozon

## Цель
Автоматически выгружать товары из МойСклад и создавать/обновлять карточки товаров на Ozon.

## Этапы реализации

### 1. Анализ и Подготовка
- [ ] **Поиск по фото**: Ozon API не поддерживает поиск по фото. Решение: Использовать Playwright для поиска через Яндекс.Картинки (`site:ozon.ru`) или Google Lens.
- [ ] **Данные товара**: Ozon API не отдаёт данные чужих товаров. Решение: Парсинг публичной страницы товара Ozon.
- [ ] **Хостинг картинок**: MS картинки локальны. Если использовать картинки с найденного товара Ozon — проблема решена. Если нужны свои — нужен публичный хостинг (S3/Supabase Cloud).
- [ ] Получить ID "Основного склада" в МойСклад (Готово: `de940fd4-23f4-11ef-0a80-0eb00010b17c`).

### 2. Базовая настройка
- [ ] Создать проект/папку `ozon-automation`.
- [ ] **Credentials**: Запросить `OZON_CLIENT_ID` и `OZON_API_KEY` у пользователя и добавить в `.env`.
- [ ] Настроить доступ к API МойСклад (Готово).

### 3. Сбор данных из МойСклад
- [x] Проверка доступа к картинкам (Готово).
- [ ] Скрипт `get_ms_products.py`:
    - Получает товары с `stock > 0` из Основного склада.
    - Фильтрует товары без картинок.
    - Сохраняет данные (ID, Name, Image Path) в `products_to_process.json`.
    - Скачивает изображения в папку `ozon-automation/images`.

### 4. Поиск и Парсинг (Magic Step)
- [ ] Скрипт `find_ozon_match.py` (Playwright):
    - Берет фото из `ozon-automation/images`.
    - Загружает в Яндекс.Картинки.
    - Ищет ссылку на `ozon.ru`.
    - Если найдено: переходит на Ozon, парсит Название, Описание, Характеристики, Категорию, Ссылки на фото.
    - Сохраняет результат в `matched_products.json`.

### 5. Создание карточек в Ozon
- [ ] Скрипт `create_ozon_cards.py`:
    - Читает `matched_products.json`.
    - Формирует JSON для `v2/product/import`.
    - Использует цену и остаток из МС.
    - Отправляет запрос в Ozon Seller API.
    - Логирует результат (Task ID).

### 6. Тестирование
- [ ] Ручной запуск цепочки на 1 товаре.

## Вопросы к обсуждению
1. Как мы будем выбирать товары для выгрузки? (Все, или специальная папка/тег в МС?)
2. Как сопоставлять категории? (Вручную прописать ID категорий Ozon для групп товаров МС?)
3. Где хранятся фото? (В МС? Ссылки доступны извне?)
